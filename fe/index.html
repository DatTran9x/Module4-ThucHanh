<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cities</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>

<div>

    <div class="container">
        <button data-toggle="modal" data-target="#create" class="btn btn-primary">Add new city</button>
    </div>
    <div class="container">
        <table class="table table">
            <div class="header">
                <tr>
                    <th>#</th>
                    <th>City</th>
                    <th>Country</th>
                    <th colspan="2">Action</th>
                </tr>
            </div>
            <div>
                <tbody id="t-body">

                </tbody>
            </div>
        </table>
    </div>

</div>


<div>

    <div class="modal fade" id="create" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">

            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add new city</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">
                    <div class="form-group">
                        <label for="createName">City:</label>
                        <input type="text" class="form-control" id="createName">
                    </div>
                    <div class="form-group">
                        <label for="createCountry">Country:</label>
                        <input type="text" class="form-control" id="createCountry">
                    </div>
                    <div class="form-group">
                        <label for="createArea">Area:</label>
                        <input type="text" class="form-control" id="createArea">
                    </div>
                    <div class="form-group">
                        <label for="createPopulation">Population:</label>
                        <input type="text" class="form-control" id="createPopulation">
                    </div>
                    <div class="form-group">
                        <label for="createGDP">GDP:</label>
                        <input type="text" class="form-control" id="createGDP">
                    </div>
                    <div class="form-group">
                        <label for="createDescription">Description:</label>
                        <input type="text" class="form-control" id="createDescription">
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="create()" data-dismiss="modal">Save
                    </button>
                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="edit" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">

            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit city</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">
                    <div class="form-group">
                        <label for="editName">City:</label>
                        <input type="text" class="form-control" id="editName">
                    </div>
                    <div class="form-group">
                        <label for="editCountry">Country:</label>
                        <input type="text" class="form-control" id="editCountry">
                    </div>
                    <div class="form-group">
                        <label for="editArea">Area:</label>
                        <input type="text" class="form-control" id="editArea">
                    </div>
                    <div class="form-group">
                        <label for="editPopulation">Population:</label>
                        <input type="text" class="form-control" id="editPopulation">
                    </div>
                    <div class="form-group">
                        <label for="editGDP">GDP:</label>
                        <input type="text" class="form-control" id="editGDP">
                    </div>
                    <div class="form-group">
                        <label for="editDescription">Description:</label>
                        <input type="text" class="form-control" id="editDescription">
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" id="editId" hidden>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="edit()" data-dismiss="modal">Save
                    </button>
                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="delete" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">

            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Delete city</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">
                    <div class="form-group">
                        <label for="deleteName">City:</label>
                        <input type="text" class="form-control" id="deleteName">
                    </div>
                    <div class="form-group">
                        <label for="editCountry">Country:</label>
                        <input type="text" class="form-control" id="deleteCountry">
                    </div>
                    <div class="form-group">
                        <label for="editArea">Area:</label>
                        <input type="text" class="form-control" id="deleteArea">
                    </div>
                    <div class="form-group">
                        <label for="editPopulation">Population:</label>
                        <input type="text" class="form-control" id="deletePopulation">
                    </div>
                    <div class="form-group">
                        <label for="editGDP">GDP:</label>
                        <input type="text" class="form-control" id="deleteGDP">
                    </div>
                    <div class="form-group">
                        <label for="editDescription">Description:</label>
                        <input type="text" class="form-control" id="deleteDescription">
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" id="deleteId" hidden="true">
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="deleteCity()" data-dismiss="modal">Delete
                    </button>
                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="detail" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">

            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">City's detail</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">
                    <div class="form-group">
                        <label for="deleteName">City:</label>
                        <input type="text" class="form-control" id="detailName">
                    </div>
                    <div class="form-group">
                        <label for="editCountry">Country:</label>
                        <input type="text" class="form-control" id="detailCountry">
                    </div>
                    <div class="form-group">
                        <label for="editArea">Area:</label>
                        <input type="text" class="form-control" id="detailArea">
                    </div>
                    <div class="form-group">
                        <label for="editPopulation">Population:</label>
                        <input type="text" class="form-control" id="detailPopulation">
                    </div>
                    <div class="form-group">
                        <label for="editGDP">GDP:</label>
                        <input type="text" class="form-control" id="detailGDP">
                    </div>
                    <div class="form-group">
                        <label for="editDescription">Description:</label>
                        <input type="text" class="form-control" id="detailDescription">
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </button>
                </div>

            </div>
        </div>
    </div>

</div>

</body>
</html>

<script>
    function show() {
        $.ajax({
            type: "GET",
            url: "http://localhost:8080/home",
            success: function (data) {
                let tr = "";
                for (let i = 0; i < data.length; i++) {
                    tr += "<tr>"
                    tr += `<td>${data[i].id}</td>`
                    tr += `<td><a onclick="detail(${data[i].id})" value="123"  data-toggle="modal" data-target="#detail">${data[i].name}</td>`
                    tr += `<td>${data[i].country}</td>`
                    tr += `<td><button class="btn btn-primary" onclick="showEdit(${data[i].id})" data-toggle="modal" data-target="#edit">Edit</button></td>`
                    tr += `<td><button class="btn btn-primary" onclick="showDelete(${data[i].id})" data-toggle="modal" data-target="#delete">Delete</button></td>`
                    tr += "</tr>"
                }
                document.getElementById("t-body").innerHTML = tr;
            },
            error: function (err) {
                console.log(err);
            }
        })
    }

    function detail(id) {
        $.ajax({
            type: "GET",
            url: "http://localhost:8080/home/"+id,
            success: function (data) {
                console.log(data);
                document.getElementById("detailName").value = data.name;
                document.getElementById("detailCountry").value = data.country;
                document.getElementById("detailPopulation").value = data.population;
                document.getElementById("detailGDP").value = data.gdp;
                document.getElementById("detailArea").value = data.area;
                document.getElementById("detailDescription").value = data.description;
            },
            error: function (err) {
                console.log(err);
            }
        })
    }

    show();

    function create() {
        let name = document.getElementById("createName").value;
        let country = document.getElementById("createCountry").value;
        let population = document.getElementById("createPopulation").value;
        let GDP = document.getElementById("createGDP").value;
        let area = document.getElementById("createArea").value;
        let description = document.getElementById("createDescription").value
        let city = {
            name : name,
            country : country,
            population : population,
            GDP : GDP,
            area : area,
            description : description
        }
        $.ajax({
            type: "POST",
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            data: JSON.stringify(city),
            url: "http://localhost:8080/home",
            success: function (data) {
                console.log(data);
                show();
            },
            error: function (err) {
                console.log(err);
            }
        })
    }

    function showEdit(id) {
        $.ajax({
            type: "GET",
            url: "http://localhost:8080/home/"+id,
            success: function (data) {
                console.log(data);
                document.getElementById("editName").value = data.name;
                document.getElementById("editCountry").value = data.country;
                document.getElementById("editPopulation").value = data.population;
                document.getElementById("editGDP").value = data.gdp;
                document.getElementById("editArea").value = data.area;
                document.getElementById("editDescription").value = data.description;
                document.getElementById("editId").value = data.id;
            },
            error: function (err) {
                console.log(err);
            }
        })
    }

    function edit(){
        let name = document.getElementById("editName").value;
        let country = document.getElementById("editCountry").value;
        let population = document.getElementById("editPopulation").value;
        let GDP = document.getElementById("editGDP").value;
        let area = document.getElementById("editArea").value;
        let description = document.getElementById("editDescription").value
        let id = document.getElementById("editId").value;
        let city = {
            id:id,
            name : name,
            country : country,
            population : population,
            GDP : GDP,
            area : area,
            description : description
        }
        $.ajax({
            type: "PUT",
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            data: JSON.stringify(city),
            url: "http://localhost:8080/home",
            success: function (data) {
                console.log(data);
                show();
            },
            error: function (err) {
                console.log(err);
            }
        })
    }

    function showDelete(id) {
        $.ajax({
            type: "GET",
            url: "http://localhost:8080/home/"+id,
            success: function (data) {
                console.log(data);
                document.getElementById("deleteName").value = data.name;
                document.getElementById("deleteCountry").value = data.country;
                document.getElementById("deletePopulation").value = data.population;
                document.getElementById("deleteGDP").value = data.gdp;
                document.getElementById("deleteArea").value = data.area;
                document.getElementById("deleteDescription").value = data.description;
                document.getElementById("deleteId").value = data.id;
            },
            error: function (err) {
                console.log(err);
            }
        })
    }

    function deleteCity(){
        let id = document.getElementById("deleteId").value;
        console.log(id);
        $.ajax({
            type: "DELETE",
            url: "http://localhost:8080/home/"+id,
            success: function (data) {
                console.log(data);
                show();
            },
            error: function (err) {
                console.log(err);
            }
        })
    }
</script>